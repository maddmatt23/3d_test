<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Know-Hub — 3D Scroll Experience</title>
  <style>
    :root{
      --bg-light: #f7f7f8;
      --bg-dark: #e3e4e8;
      --panel: #ffffff;
      --panel-border: #dcdde1;
      --text: #222;
      --muted: #666;
      --orange: #ff6a00;
      --blue: #2ea8ff;
    }

    html, body {
      margin:0;
      background: linear-gradient(180deg, var(--bg-light), var(--bg-dark));
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      overflow-x:hidden;
    }

    /* Navbar */
    nav{
      position: fixed; inset: 16px 16px auto 16px; height: 52px;
      display:flex; align-items:center; justify-content:space-between;
      padding: 0 16px;
      background: rgba(255,255,255,0.75);
      border: 1px solid var(--panel-border);
      border-radius: 14px;
      backdrop-filter: blur(10px);
      z-index: 60;
      box-shadow: 0 4px 16px rgba(0,0,0,0.06);
    }
    .brand{
      font-weight: 700; font-size: 18px;
      background: linear-gradient(90deg, var(--orange), var(--blue));
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }
    .nav-links{ display:flex; gap:12px; }
    .nav-btn{
      padding:8px 14px; border-radius: 10px; font-weight:500;
      background: #fff;
      border:1px solid var(--panel-border);
      color: var(--text);
      cursor:pointer; font-size:14px;
      transition: all .15s ease;
    }
    .nav-btn:hover{ background:#f0f0f0; }

    /* Title */
    header#title{
      position: fixed; top: 90px; left:50%; transform: translateX(-50%);
      z-index: 40;
      font-size: clamp(28px, 6vw, 56px);
      font-weight: 700; letter-spacing:.02em;
      color: var(--text);
      pointer-events:none; transition: opacity .2s linear;
    }

    /* Canvas */
    #stage{
      position: fixed; inset: 0; width: 100%; height:100%;
      z-index: 5; pointer-events: none;
      transition: filter .18s linear;
    }

    /* Content */
    .wrap{ max-width: 1000px; margin: 0 auto; padding: 140px 20px 60px; position:relative; z-index: 20; }
    section{ margin: 120px 0; }

    .panel{
      border-radius: 16px;
      background: var(--panel);
      border: 1px solid var(--panel-border);
      padding:28px;
      box-shadow: 0 6px 18px rgba(0,0,0,.06);
    }
    .panel h2{ margin:0 0 8px 0; }

    .spacer{ height: 300vh; }

    #log{
      position: fixed; bottom: 18px; left: 18px; z-index: 70;
      background: rgba(0,0,0,0.7); color: #9cf19b;
      padding:6px 10px; border-radius: 8px;
      font: 12px ui-monospace;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav>
    <div class="brand">Know-Hub</div>
    <div class="nav-links">
      <button class="nav-btn">Home</button>
      <button class="nav-btn">About</button>
      <button class="nav-btn">Products</button>
      <button class="nav-btn">Contact</button>
    </div>
  </nav>

  <!-- Title -->
  <header id="title">Know-Hub</header>

  <!-- Content above -->
  <div class="wrap">
    <section class="panel">
      <h2>Welcome to Know-Hub</h2>
      <p>Explore interactive 3D models with smooth scroll-driven rotation, powered by HDR lighting for realism.</p>
    </section>
  </div>

  <!-- Canvas -->
  <canvas id="stage"></canvas>

  <!-- Content below -->
  <div class="wrap">
    <section class="panel">
      <h2>Modern & Minimal</h2>
      <p>A clean gradient background with subtle accents makes your product the hero. Orange and blue highlights are understated for a professional look.</p>
    </section>
    <section class="panel">
      <h2>Scroll-Driven Focus</h2>
      <p>As you scroll, the model rotates a full 360°. When content overlaps, the model softly blurs, keeping the text in focus.</p>
    </section>
  </div>

  <div class="spacer"></div>
  <div id="log">Loading…</div>

  <!-- Three.js + Loaders -->
  <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/RGBELoader.js"></script>

  <script>
    const titleEl = document.getElementById('title');
    const canvasEl = document.getElementById('stage');
    const logEl = document.getElementById('log');
    const log = m => { logEl.textContent = m; };

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(35, window.innerWidth/window.innerHeight, 0.1, 100);
    camera.position.set(0, 0.5, 2.5);

    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true, canvas: canvasEl });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.0;
    renderer.outputEncoding = THREE.sRGBEncoding;

    // Lights
    const hemi = new THREE.HemisphereLight(0xffffff, 0xaaaaaa, 0.4);
    scene.add(hemi);

    // HDR Environment
    new THREE.RGBELoader()
      .setPath('models/')
      .load('studio_small_08_1k.hdr', function(texture) {
        texture.mapping = THREE.EquirectangularReflectionMapping;
        scene.environment = texture;
        log('HDR loaded ✅');
      }, undefined, function(err){
        log('HDR load error ❌');
        console.error(err);
      });

    // Load Model
    const loader = new THREE.GLTFLoader();
    let model = null;
    loader.load('models/test.glb', (gltf)=>{
      model = gltf.scene;

      // Center + scale
      const box = new THREE.Box3().setFromObject(model);
      const size = new THREE.Vector3(); box.getSize(size);
      const center = new THREE.Vector3(); box.getCenter(center);
      const maxDim = Math.max(size.x, size.y, size.z) || 1.0;

      const scale = 1.0 / maxDim;
      model.scale.setScalar(scale);
      model.position.sub(center.multiplyScalar(scale));
      model.position.y += 0.5;  // a bit higher, to center visually

      scene.add(model);
      log('Model loaded ✅');
      animate();
    }, (xhr)=>{
      if (xhr.total) log(`Loading model… ${(xhr.loaded/xhr.total*100).toFixed(0)}%`);
    }, (err)=>{
      log('Model load error ❌');
      console.error(err);
    });

    // Scroll progress
    function scrollProgress(){
      const max = document.body.scrollHeight - window.innerHeight;
      return max > 0 ? window.scrollY / max : 0;
    }

    // Animate
    function animate(){
      requestAnimationFrame(animate);

      if(model){
        const p = scrollProgress();
        model.rotation.y = p * Math.PI * 2;
      }

      const fadePoint = window.innerHeight * 0.4;
      titleEl.style.opacity = Math.max(0, 1 - window.scrollY / fadePoint).toFixed(2);

      renderer.render(scene, camera);
    }

    window.addEventListener('resize', ()=>{
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
