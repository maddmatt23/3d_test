<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Know-Hub — 3D Scroll Experience</title>
  <style>
    :root{
      --bg: #0a0b0f;
      --panel: #0f1117;
      --panel-hi: #151826;
      --text: #e7e8ea;
      --muted: #aeb3bd;
      --line: #232737;
      --orange: #ff6a00;
      --blue: #2ea8ff;
      --glow: 0 10px 30px rgba(46,168,255,.15), 0 10px 40px rgba(255,106,0,.08);
    }

    /* Base */
    *{ box-sizing: border-box; }
    html, body { margin:0; background: var(--bg); color: var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; overflow-x:hidden; }
    a{ color:inherit; text-decoration:none; }

    /* Glassy navbar */
    nav{
      position: fixed; inset: 16px 16px auto 16px;
      height: 56px;
      display:flex; align-items:center; justify-content:space-between;
      padding: 0 16px;
      background: rgba(21,24,38,.6);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: 16px;
      backdrop-filter: blur(10px);
      box-shadow: var(--glow);
      z-index: 60;
    }
    .brand{
      display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.02em;
      background: linear-gradient(90deg, var(--orange), var(--blue));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      font-size: 18px;
    }
    .pill{
      padding:6px 10px; border-radius: 999px; font-size:12px;
      background: linear-gradient(145deg, #151827, #0c0e16);
      border:1px solid var(--line);
      color: var(--muted);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
    }
    .nav-links{ display:flex; gap:12px; }
    .nav-btn{
      padding:10px 14px; border-radius: 12px; font-weight:600;
      background: linear-gradient(145deg, #171a28, #0d0f18);
      border:1px solid var(--line); color: var(--text);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.04), 0 6px 20px rgba(0,0,0,.25);
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
      cursor:pointer;
    }
    .nav-btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.12); box-shadow: var(--glow); }
    .nav-cta{
      background: linear-gradient(145deg, #1a1f31, #0e1220);
      border:1px solid rgba(46,168,255,.35);
      box-shadow: 0 0 0 1px rgba(46,168,255,.18) inset, 0 10px 30px rgba(46,168,255,.18);
      color: var(--text);
    }

    /* Title overlay */
    header#title{
      position: fixed; top: 96px; left:50%; transform: translateX(-50%);
      z-index: 40;
      font-size: clamp(28px, 6vw, 56px);
      font-weight: 800; letter-spacing:.04em;
      background: linear-gradient(90deg, var(--orange), var(--blue));
      -webkit-background-clip: text; background-clip:text; color: transparent;
      text-shadow: 0 8px 40px rgba(46,168,255,.18);
      pointer-events:none; transition: opacity .2s linear;
      filter: drop-shadow(0 8px 24px rgba(0,0,0,.35));
    }

    /* Fixed full-viewport hero canvas behind content */
    #stage{
      position: fixed; inset: 0;
      width: 100%; height:100%;
      z-index: 5; pointer-events: none;
      transition: filter .18s linear;
    }

    /* Content scaffolding */
    .wrap{ max-width: 1100px; margin: 0 auto; padding: 140px 20px 60px; position:relative; z-index: 20; }
    section{ margin: 120px 0; }

    /* Bevelled / neumorphic panels */
    .panel{
      border-radius: 20px;
      background: linear-gradient(160deg, var(--panel-hi) 0%, var(--panel) 100%);
      border: 1px solid var(--line);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.04),
        0 20px 40px rgba(0,0,0,.35);
      overflow: hidden;
    }
    .panel .inner{ padding: 28px 28px; }
    .panel h2{ margin:0 0 8px 0; font-size: clamp(20px, 3.4vw, 30px); }
    .panel p{ margin: 0; color: var(--muted); }

    /* Accent chips */
    .chips{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 16px; }
    .chip{
      padding:8px 12px; border-radius: 999px; font-size:12px; font-weight:600; letter-spacing:.02em;
      border:1px solid var(--line);
      background: linear-gradient(145deg, #161a28, #0d101a);
      color: var(--muted);
    }
    .chip.orange{ border-color: rgba(255,106,0,.4); color:#ffd8c2; box-shadow: 0 0 0 1px rgba(255,106,0,.2) inset; }
    .chip.blue  { border-color: rgba(46,168,255,.45); color:#d3ecff; box-shadow: 0 0 0 1px rgba(46,168,255,.22) inset; }

    /* Feature grid */
    .grid{ display:grid; gap:18px; grid-template-columns: repeat(12, 1fr); }
    .card{
      grid-column: span 4;
      border-radius: 18px;
      background: linear-gradient(160deg, #141827, #0e111b);
      border: 1px solid var(--line);
      padding: 20px;
      box-shadow: inset 0 1px rgba(255,255,255,.04), 0 16px 28px rgba(0,0,0,.35);
      transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    }
    .card:hover{ transform: translateY(-2px); border-color: rgba(255,255,255,.12); box-shadow: var(--glow); }
    .eyebrow{ font-size:12px; text-transform:uppercase; letter-spacing:.14em; color: var(--muted); margin-bottom:6px; }
    .title{ font-weight:700; margin:0 0 6px 0; }
    .meta{ font-size:12px; color:#9aa4b3; }

    /* Spacer ensures full 360° scroll */
    .spacer{ height: 320vh; }

    /* Footer */
    footer{
      position: relative; z-index:20; margin-top: 80px; padding: 40px 20px 80px;
      color: var(--muted);
      border-top: 1px solid var(--line);
      background: radial-gradient(800px 300px at 50% -50px, rgba(46,168,255,.12), transparent 60%);
    }

    /* Debug chip (can remove later) */
    #log{
      position: fixed; bottom: 18px; left: 18px; z-index: 70;
      background: #0c0f17; color: #9cf19b; border:1px solid #254a2a;
      padding:6px 10px; border-radius: 10px; font: 12px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
    }

    @media (max-width: 900px){
      .grid{ grid-template-columns: repeat(6, 1fr); }
      .card{ grid-column: span 6; }
      nav{ inset: 8px; height: 52px; padding: 0 12px; }
      header#title{ top: 84px; }
    }
  </style>
</head>
<body>
  <!-- NAV -->
  <nav>
    <div class="brand">Know-Hub <span class="pill">Alpha</span></div>
    <div class="nav-links">
      <button class="nav-btn">Home</button>
      <button class="nav-btn">About</button>
      <button class="nav-btn">Products</button>
      <button class="nav-btn">Contact</button>
      <button class="nav-btn nav-cta">Menu</button>
    </div>
  </nav>

  <!-- Title -->
  <header id="title">Know-Hub</header>

  <!-- Content above hero -->
  <div class="wrap">
    <section class="panel">
      <div class="inner">
        <h2>Welcome to Know-Hub</h2>
        <p>Where clarity meets craft. Explore a smooth, scroll-driven 3D showcase with a crisp, modern UI in dark mode.</p>
        <div class="chips">
          <span class="chip orange">Performance</span>
          <span class="chip blue">Design</span>
          <span class="chip">3D Ready</span>
          <span class="chip orange">PBR</span>
          <span class="chip blue">WebGL</span>
        </div>
      </div>
    </section>
  </div>

  <!-- Fixed 3D hero canvas (behind content) -->
  <canvas id="stage"></canvas>

  <!-- Content below hero -->
  <div class="wrap">
    <section>
      <div class="grid">
        <div class="card">
          <div class="eyebrow">Experience</div>
          <h3 class="title">Scroll-Driven 360°</h3>
          <div class="meta">Spin the model smoothly as you read — clean and intuitive.</div>
        </div>
        <div class="card">
          <div class="eyebrow">Visuals</div>
          <h3 class="title" style="color:var(--orange)">Bevelled Aesthetic</h3>
          <div class="meta">Subtle depth, soft highlights, and glassy chrome touches.</div>
        </div>
        <div class="card">
          <div class="eyebrow">Polish</div>
          <h3 class="title" style="color:var(--blue)">Live Blur Behind Text</h3>
          <div class="meta">Content takes focus while the product glows in the background.</div>
        </div>
      </div>
    </section>

    <section class="panel">
      <div class="inner">
        <h2>Built for Product Storytelling</h2>
        <p>Use this hero to introduce hardware, packaging, or concept renders. Keep the narrative flowing with panels and chips.</p>
      </div>
    </section>
  </div>

  <div class="spacer"></div>

  <footer class="wrap">
    <div class="grid">
      <div class="card" style="grid-column: span 6;">
        <h3 class="title">Contact</h3>
        <div class="meta">hello@know-hub.example</div>
      </div>
      <div class="card" style="grid-column: span 6;">
        <h3 class="title">Follow</h3>
        <div class="meta">@knowhub — all platforms</div>
      </div>
    </div>
  </footer>

  <div id="log">Loading…</div>

  <!-- Three.js (legacy global style, proven working) -->
  <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>

  <script>
    // Elements
    const titleEl = document.getElementById('title');
    const canvasEl = document.getElementById('stage');
    const logEl = document.getElementById('log');
    const log = m => { logEl.textContent = m; };

    // Three.js setup
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(35, window.innerWidth/window.innerHeight, 0.1, 100);
    camera.position.set(0, 0.5, 2.5);

    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true, canvas: canvasEl });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

    // Lights
    const hemi = new THREE.HemisphereLight(0xffffff, 0x222235, 1.25); scene.add(hemi);
    const dir  = new THREE.DirectionalLight(0xffffff, 1.1); dir.position.set(2,3,2); scene.add(dir);

    // Load GLB
    const loader = new THREE.GLTFLoader();
    let model = null;
    loader.load('models/test.glb', (gltf)=>{
      model = gltf.scene;

      // Center & SCALE DOWN A BIT; LOWER slightly
      const box = new THREE.Box3().setFromObject(model);
      const size = new THREE.Vector3(); box.getSize(size);
      const center = new THREE.Vector3(); box.getCenter(center);
      const maxDim = Math.max(size.x, size.y, size.z) || 1.0;

      const scale = 0.9 / maxDim;   // smaller than before (was 1.2/maxDim)
      model.scale.setScalar(scale);
      model.position.sub(center.multiplyScalar(scale));
      model.position.y += 0.2;      // slightly down (previously +0.5 lifted more)

      scene.add(model);
      log('Model loaded ✅');
      animate();
    }, (xhr)=>{
      if (xhr.total) log(`Loading model… ${(xhr.loaded/xhr.total*100).toFixed(0)}%`);
      else log(`Loading model… ${xhr.loaded} bytes`);
    }, (err)=>{
      log('Model load error ❌ (check models/test.glb path)');
      console.error(err);
    });

    // Scroll → rotation
    function scrollProgress(){
      const max = document.body.scrollHeight - window.innerHeight;
      return max > 0 ? window.scrollY / max : 0;
    }

    function animate(){
      requestAnimationFrame(animate);

      if(model){
        const p = scrollProgress();
        model.rotation.y = p * Math.PI * 2;
      }

      // Fade title in first ~40% viewport
      const fadePoint = window.innerHeight * 0.4;
      titleEl.style.opacity = Math.max(0, 1 - window.scrollY / fadePoint).toFixed(2);

      // Blur canvas proportionally when ANY content block overlaps viewport
      const mains = document.querySelectorAll('.wrap');
      let maxBlur = 0;
      mains.forEach(sec=>{
        const r = sec.getBoundingClientRect();
        const overlap = r.top < window.innerHeight && r.bottom > 0;
        if(overlap){
          const visible = Math.min(window.innerHeight, r.bottom) - Math.max(0, r.top);
          const k = Math.max(0, Math.min(1, visible / window.innerHeight));
          maxBlur = Math.max(maxBlur, k * 8); // up to 8px
        }
      });
      if(maxBlur > 0){
        canvasEl.style.filter = `blur(${maxBlur.toFixed(1)}px) brightness(${1 - maxBlur/22})`;
      } else {
        canvasEl.style.filter = 'none';
      }

      renderer.render(scene, camera);
    }

    // Resize
    window.addEventListener('resize', ()=>{
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
