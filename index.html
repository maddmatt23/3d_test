<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Know-Hub — 3D Scroll Experience</title>
  <style>
    :root{
      --bg: #0a0b0f;
      --panel: #0f1117;
      --panel-hi: #151826;
      --text: #e7e8ea;
      --muted: #aeb3bd;
      --line: #232737;
      --orange: #ff6a00;
      --blue: #2ea8ff;
      --glow: 0 10px 30px rgba(46,168,255,.15), 0 10px 40px rgba(255,106,0,.08);
    }

    html, body {
      margin:0; background: var(--bg); color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      overflow-x:hidden;
    }
    a{ color:inherit; text-decoration:none; }

    /* Navbar */
    nav{
      position: fixed; inset: 16px 16px auto 16px; height: 56px;
      display:flex; align-items:center; justify-content:space-between;
      padding: 0 16px;
      background: rgba(21,24,38,.6);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: 16px;
      backdrop-filter: blur(10px);
      box-shadow: var(--glow);
      z-index: 60;
    }
    .brand{
      font-weight: 700; font-size: 18px;
      background: linear-gradient(90deg, var(--orange), var(--blue));
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }
    .nav-links{ display:flex; gap:12px; }
    .nav-btn{
      padding:8px 14px; border-radius: 12px; font-weight:600;
      background: linear-gradient(145deg, #171a28, #0d0f18);
      border:1px solid var(--line); color: var(--text);
      cursor:pointer; font-size:14px;
    }

    /* Title */
    header#title{
      position: fixed; top: 96px; left:50%; transform: translateX(-50%);
      z-index: 40;
      font-size: clamp(28px, 6vw, 56px);
      font-weight: 800; letter-spacing:.04em;
      background: linear-gradient(90deg, var(--orange), var(--blue));
      -webkit-background-clip: text; background-clip:text; color: transparent;
      text-shadow: 0 8px 40px rgba(46,168,255,.18);
      pointer-events:none; transition: opacity .2s linear;
    }

    /* Canvas */
    #stage{
      position: fixed; inset: 0; width: 100%; height:100%;
      z-index: 5; pointer-events: none;
      transition: filter .18s linear;
    }

    /* Content */
    .wrap{ max-width: 1100px; margin: 0 auto; padding: 140px 20px 60px; position:relative; z-index: 20; }
    section{ margin: 120px 0; }
    .panel{ border-radius: 20px; background: var(--panel); padding:28px; box-shadow: 0 20px 40px rgba(0,0,0,.35); }
    .panel h2{ margin:0 0 8px 0; }

    .spacer{ height: 320vh; }

    #log{
      position: fixed; bottom: 18px; left: 18px; z-index: 70;
      background: #0c0f17; color: #9cf19b; border:1px solid #254a2a;
      padding:6px 10px; border-radius: 10px; font: 12px ui-monospace;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav>
    <div class="brand">Know-Hub</div>
    <div class="nav-links">
      <button class="nav-btn">Home</button>
      <button class="nav-btn">About</button>
      <button class="nav-btn">Products</button>
      <button class="nav-btn">Contact</button>
    </div>
  </nav>

  <!-- Title -->
  <header id="title">Know-Hub</header>

  <!-- Content above -->
  <div class="wrap">
    <section class="panel">
      <h2>Welcome to Know-Hub</h2>
      <p>Scroll down and see the 3D model in full interactive glory, with HDR reflections for realism.</p>
    </section>
  </div>

  <!-- Canvas -->
  <canvas id="stage"></canvas>

  <!-- Content below -->
  <div class="wrap">
    <section class="panel">
      <h2>Immersive Storytelling</h2>
      <p>Your products shine with Apple-like polish, thanks to scroll-driven 360° views and soft HDR lighting.</p>
    </section>
  </div>

  <div class="spacer"></div>
  <div id="log">Loading…</div>

  <!-- Three.js + Loaders -->
  <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/RGBELoader.js"></script>

  <script>
    const titleEl = document.getElementById('title');
    const canvasEl = document.getElementById('stage');
    const logEl = document.getElementById('log');
    const log = m => { logEl.textContent = m; };

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(35, window.innerWidth/window.innerHeight, 0.1, 100);
    camera.position.set(0, 0.5, 2.5);

    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true, canvas: canvasEl });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.toneMapping = THREE.ACESFilmicToneMapping;
    renderer.toneMappingExposure = 1.1;
    renderer.outputEncoding = THREE.sRGBEncoding;

    // Lights
    const hemi = new THREE.HemisphereLight(0xffffff, 0x222235, 0.6);
    scene.add(hemi);

    // HDR Environment
    new THREE.RGBELoader()
      .setPath('models/')
      .load('studio_small_08_1k.hdr', function(texture) {
        texture.mapping = THREE.EquirectangularReflectionMapping;
        scene.environment = texture;
        log('HDR loaded ✅');
      }, undefined, function(err){
        log('HDR load error ❌');
        console.error(err);
      });

    // Load Model
    const loader = new THREE.GLTFLoader();
    let model = null;
    loader.load('models/test.glb', (gltf)=>{
      model = gltf.scene;

      // Center + scale
      const box = new THREE.Box3().setFromObject(model);
      const size = new THREE.Vector3(); box.getSize(size);
      const center = new THREE.Vector3(); box.getCenter(center);
      const maxDim = Math.max(size.x, size.y, size.z) || 1.0;

      const scale = 1.0 / maxDim;  // scaled down a touch
      model.scale.setScalar(scale);
      model.position.sub(center.multiplyScalar(scale));
      model.position.y += 0.4;  // raised up again so it looks centered

      scene.add(model);
      log('Model loaded ✅');
      animate();
    }, (xhr)=>{
      if (xhr.total) log(`Loading model… ${(xhr.loaded/xhr.total*100).toFixed(0)}%`);
    }, (err)=>{
      log('Model load error ❌ (check models/test.glb path)');
      console.error(err);
    });

    // Scroll progress
    function scrollProgress(){
      const max = document.body.scrollHeight - window.innerHeight;
      return max > 0 ? window.scrollY / max : 0;
    }

    // Animate loop
    function animate(){
      requestAnimationFrame(animate);

      if(model){
        const p = scrollProgress();
        model.rotation.y = p * Math.PI * 2;
      }

      const fadePoint = window.innerHeight * 0.4;
      titleEl.style.opacity = Math.max(0, 1 - window.scrollY / fadePoint).toFixed(2);

      renderer.render(scene, camera);
    }

    window.addEventListener('resize', ()=>{
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
